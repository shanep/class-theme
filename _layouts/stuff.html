
{% assign one_day = 1 | times: 24 | times: 60 | times: 60 %}
{% assign two_days = 2 | times: 24 | times: 60 | times: 60 %}
{% assign three_days = 3 | times: 24 | times: 60 | times: 60 %}
{% assign four_days = 4 | times: 24 | times: 60 | times: 60 %}


{% if tableFile.start-day == "monday" %}
{% assign curr_date = tableFile.start-date | date: "%s" | minus: four_days%}
{% elsif tableFile.start-day == "tuesday" %}
{% assign curr_date = tableFile.start-date | date: "%s" | minus: three_days%}
{% elsif tableFile.start-day == "wednesday" %}
{% assign curr_date = tableFile.start-date | date: "%s" | minus: two_days%}
{% elsif tableFile.start-day == "thursday" %}
{% assign curr_date = tableFile.start-date | date: "%s" | minus: one_day %}
{% endif%}

<h2 id="homework">Weekly Homework</h2>
<p>
    The table below shows everything that is due this semester! Barring any cataclysmic events such as a
    <a href="https://en.wikipedia.org/wiki/COVID-19">global pandemic,</a> nothing will be added,
    removed, or changed in the schedule below. 
</p>

<table style="margin:auto;height: 100%; width: 100%;">
    <thead>
    <tr>
        <th class="text-center">Week</th>
        <th>Due Date</th>
        <th>Homework</th>
        <th>Points</th>
    </tr>
    </thead>

    <tbody>
    {% assign curr_week = 1 %}
    {% assign curr_module = "none" %}

    {% assign loop_counter = 1 %}
    {% assign pgs = site.lessons | sort: 'slug' %}
    {% assign total_points = 0%}
    {% for page in pgs %}
        {% if page.path contains "lesson"  %}
        {% assign loop_counter = loop_counter | plus: 1 %}
        {% if curr_module != page.tag %}
        <!--Module header-->
            <tr>
            <td colspan="4" class="text-center table-darkish">{{page.tag | capitalize }}</td>
            </tr>
            {% assign curr_module = page.tag %}
        {% endif%}
        {% if page.layout == "reading-zybooks" %}
            {% assign page_title = site.data.semester-info.reading[page.slug] %}         
        {% else%}
            {% assign page_title = page.title %}
        {% endif %}
            
        

        {% if curr_week == tableFile.break %}
            <!--Add in the break week, we need to grab the next lesson before inserting new week-->
            <tr>
            {% assign curr_date = curr_date | date: "%s" | plus: two_days %}
            <td>{{curr_date | date: "%m/%d - %a"}}</td>
            <td><a href="{{site.url}}{{page.url}}">{{page_title}}</a> <span class="small-text">{{page.slug}}</span>{%if page.layout == "lab"%} <a class="no-dec" href="{{site.data.semester-info.labs[page.slug]}}">ðŸ§ª</a> {%elsif page.layout == "project" %} ðŸ“¡ {% endif%} {%if page.video %}<a class="no-dec" href=https://www.youtube.com/watch?v={{page.video}}>ðŸ“º </a>{% endif %}</td>
            <td>{{page.points}}</td>
            {% assign total_points = total_points | plus: page.points %}
            </tr>
            <tr>
            <td rowspan= 2 class="table-lightish text-center border">
                {% assign curr_date = curr_date | date: "%s" | plus: three_days %}
                {{curr_week}}  
            </td>
            {% assign curr_date = curr_date | date: "%s" | plus: two_days %}
            <td>{{curr_date | date: "%m/%d - %a"}}</td>
            <td>Break</td>
            </tr>
            <tr>
            {% assign curr_date = curr_date | date: "%s" | plus: two_days %}
            <td>{{curr_date | date: "%m/%d - %a"}}</td>
            <td>Break</td>
            </tr>
            {% assign curr_week = curr_week | plus: 1 %}
        {%else%}

        <tr>
            {% comment %} 
            Need to keep track of our own loop counter to filter out docs don't use forloop.index
            {% endcomment %}
            {% assign tmp = loop_counter | modulo: 2 %}
            {% if tmp == 0 %}        
            <td rowspan= 2 class="table-lightish text-center border">
            {% assign curr_date = curr_date | date: "%s" | plus: three_days %}
            {{curr_week}}          
            {% assign curr_week = curr_week | plus: 1 %}
            </td>       
            {% endif %}
            {% assign curr_date = curr_date | date: "%s" | plus: two_days %}
            <td>{{curr_date | date: "%m/%d - %a"}}</td>
            <td><a href="{{site.url}}{{page.url}}">{{page_title}}</a> <span class="small-text">{{page.slug}}</span>{%if page.layout == "lab"%} <a class="no-dec" href="{{site.data.semester-info.labs[page.slug]}}">ðŸ§ª</a> {%elsif page.layout == "project" %} ðŸ“¡ {% endif%} {%if page.video %}<a class="no-dec" href=https://www.youtube.com/watch?v={{page.video}}>ðŸ“º </a>{% endif %}</td>
            <td>{{page.points}}</td>
            {% assign total_points = total_points | plus: page.points %}
        </tr>
        {%endif%}
        {% endif %}  
    {% endfor%}
    </tbody>
    <tfoot>
    <tr>
        <td colspan="3" class="table-lightish">Total Points:</td>
        <td class="table-lightish">{{total_points}}</td>
    </tr>
    </tfoot>
</table>